-- Tele lần lượt qua checkpoint (fix: chỉ tele đến vị trí hợp lệ)
local player = game.Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local hrp = char:WaitForChild("HumanoidRootPart")

-- hàm lấy vị trí hợp lệ từ checkpoint
local function getPositionFromCheckpoint(obj)
    if obj:IsA("BasePart") then
        return obj.Position
    elseif obj:IsA("Model") then
        if obj.PrimaryPart then
            return obj.PrimaryPart.Position
        else
            local part = obj:FindFirstChildWhichIsA("BasePart")
            if part then
                return part.Position
            end
        end
    end
    return nil
end

-- tìm toàn bộ checkpoint
local checkpoints = {}
for _, obj in ipairs(workspace:GetDescendants()) do
    if string.find(obj.Name:lower(), "checkpoint") then
        local pos = getPositionFromCheckpoint(obj)
        if pos then
            table.insert(checkpoints, {obj=obj, pos=pos})
        end
    end
end

-- sắp xếp theo số (Checkpoint1, Checkpoint2, ...)
table.sort(checkpoints, function(a, b)
    local numA = tonumber(a.obj.Name:match("%d+")) or math.huge
    local numB = tonumber(b.obj.Name:match("%d+")) or math.huge
    return numA < numB
end)

-- tele lần lượt
while true do
    for _, cp in ipairs(checkpoints) do
        if cp.pos then
            hrp.CFrame = CFrame.new(cp.pos + Vector3.new(0, 3, 0))
            task.wait(2) -- chỉnh thời gian delay giữa mỗi lần tele
        end
    end
end
